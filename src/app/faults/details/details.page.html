<ng-template #caseDetails>
  <form [formGroup]="faultDetailsForm">
    <ion-grid>
      <ion-row>
        <ion-col size="25" *ngIf="faultId">
          <ion-item>
            <ion-label position="floating">Urgency Status</ion-label>
            <ion-select interface="popover" formControlName="urgencyStatus">
              <ion-select-option [value]="item.index" *ngFor="let item of faultUrgencyStatuses">
                {{ item.value }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col [size]="faultId? 75 : 100">
          <ion-item>
            <ion-label position="floating">Fault description<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-textarea formControlName="notes" rows="1" auto-grow="true" class="fault-description"></ion-textarea>
          </ion-item>
          <app-validation-message [control]="faultDetailsForm.controls.notes"></app-validation-message>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ng-template>

<ng-template #additionalInfo>
  <form [formGroup]="addAdditionalDetForm">
    <ion-grid>
      <ion-row>
        <ion-col size-xl="50" size="100">
          <ion-grid class="additional-info-container">
            <ion-row>
              <ion-col size="40">
                <ion-item>
                  <ion-label position="floating">Type</ion-label>

                  <ion-select interface="popover" formControlName="label" [interfaceOptions]="{'cssClass': 'select-options-content-wrap'}" >
                    <ion-select-option text-wrap [value]="item" *ngFor="let item of addtionalInfo">{{ item }}
                    </ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-col>
              <ion-col size="50">
                <ion-item>
                  <ion-label position="floating">Additional Info</ion-label>
                  <ion-input formControlName="value"></ion-input>
                </ion-item>
              </ion-col>
              <ion-col size="10">
                <ion-button class="margin-top-16" [disabled]="!addAdditionalDetForm.valid"
                  (click)="createAdditionalInfo(addAdditionalDetForm.value)">Add</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>

  <form [formGroup]="faultDetailsForm">
    <ion-grid>
      <ion-row formArrayName="additionalInfo">
        <ion-col size-xl="50" size="100" *ngFor="let item of additionalInfoControls; let i = index;">
          <ng-container [formGroupName]="i">
            <ion-grid>
              <ion-row>
                <ion-col size="40">
                  <ion-item>
                    <ion-label position="floating">Type</ion-label>
                    <ion-select interface="popover" formControlName="label" [interfaceOptions]="{'cssClass': 'select-options-content-wrap'}">
                      <ion-select-option [value]="item" *ngFor="let item of addtionalInfo">{{ item }}
                      </ion-select-option>
                    </ion-select>
                  </ion-item>
                </ion-col>
                <ion-col size="50">
                  <ion-item>
                    <ion-label position="floating">Additional Info</ion-label>
                    <ion-input formControlName="value"></ion-input>
                  </ion-item>
                </ion-col>
                <ion-col size="10">
                  <ion-icon name="close-circle" class="close-circle" (click)="removeInfo(i)"></ion-icon>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ng-container>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ng-template>

<ng-template #reportedBy>
  <form [formGroup]="reportedByForm">
    <ion-grid>
      <ion-row>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Who reported the fault?<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="reportedBy" (ionChange)="onSelectReportedByType()">
              <ion-select-option [value]="item.index" *ngFor="let item of reportedByTypes">{{ item.value }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.reportedBy"></app-validation-message>
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Select agreement<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select formControlName="agreementId" interface="popover" (ionChange)="onSelectAgreement()"
              [disabled]="reportedByForm.controls.reportedBy.value != 'TENANT' && reportedByForm.controls.reportedBy.value != 'GUARANTOR'" [interfaceOptions]="{'cssClass': 'ion-select-popover-content'}">
              <ion-select-option [value]="item.agreementId" *ngFor="let item of propertyTenancyList">
                {{getLookupValue(item.status, agreementStatuses)}} {{item.tenancyStartDate | date:'dd/MM/yyyy'}} -
                {{item.tenancyEndDate| date:'dd/MM/yyyy'}}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.agreementId"></app-validation-message>
        </ion-col>

        <ion-col size="33.3" *ngIf="reportedByForm.controls.reportedBy.value === 'LANDLORD'">
          <ion-item>
            <ion-label position="floating">Select Landlord<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="selectedEntity"
              (ionChange)="setEntityData(reportedByForm.controls.selectedEntity.value)">
              <ion-select-option [value]="item" *ngFor="let item of landlordsOfproperty">{{item.addressee || item.name}}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.selectedEntity"></app-validation-message>
        </ion-col>

        <ion-col size="33.3" *ngIf="reportedByForm.controls.reportedBy.value === 'TENANT'">
          <ion-item>
            <ion-label position="floating">Select Tenant<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="selectedEntity"
              (ionChange)="setEntityData(reportedByForm.controls.selectedEntity.value)">
              <ion-select-option [value]="item" *ngFor="let item of propertyTenants">{{item.addressee || item.name}}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.selectedEntity"></app-validation-message>
        </ion-col>

        <ion-col size="33.3" *ngIf="reportedByForm.controls.reportedBy.value === 'GUARANTOR'">
          <ion-item>
            <ion-label position="floating">Select Guarantor<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="selectedEntity"
              (ionChange)="setEntityData(reportedByForm.controls.selectedEntity.value)">
              <ion-select-option [value]="item" *ngFor="let item of allGuarantors">
                {{item.displayAs}}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.selectedEntity"></app-validation-message>
        </ion-col>

        <ion-col size="33.3" *ngIf="reportedByForm.controls.reportedBy.value === 'THIRD_PARTY'">
          <ion-item>
            <ion-label position="floating">Select Third Party<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="reportedById">
              <ion-select-option [value]="item.index" *ngFor="let item of faultReportedByThirdParty">{{item.value}}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="reportedByForm.controls.reportedById"></app-validation-message>
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Title</ion-label>
            <ion-input formControlName="title"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Forename</ion-label>
            <ion-input formControlName="forename"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Surname</ion-label>
            <ion-input formControlName="surname"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">E-mail</ion-label>
            <ion-input formControlName="email"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Mobile</ion-label>
            <ion-input formControlName="mobile"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Telephone</ion-label>
            <ion-input formControlName="alternativeNo"></ion-input>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ng-template>

<ng-template #accessInformation>
  <form [formGroup]="accessInfoForm">
    <ion-grid>
      <ion-row>
        <ion-col size="33.3">
          <ion-item>
            <ion-label position="floating">Access information<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-select interface="popover" formControlName="isTenantPresenceRequired" [interfaceOptions]="{'cssClass': 'ion-select-popover-content'}">
              <ion-select-option [value]="item.value" *ngFor="let item of accessInfoList">{{ item.title }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <app-validation-message [control]="accessInfoForm.controls.isTenantPresenceRequired"></app-validation-message>
        </ion-col>
        <ion-col size="65">
          <ion-item lines="none" style="margin-top: 6px;">
            <ion-label>Is there a vulnerable occupier at this property?</ion-label>
            <ion-toggle slot="start" formControlName="areOccupiersVulnerable"></ion-toggle>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
        <ion-col size="100">
          <ion-item>
            <ion-label position="floating">Useful instructions</ion-label>
            <ion-textarea rows="1" formControlName="tenantNotes" auto-grow="true"></ion-textarea>
          </ion-item>
          <!-- <app-validation-message [control]=""></app-validation-message> -->
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ng-template>

<ng-template #media>
  <ion-grid [hidden]="mediaType != 'upload'">
    <ion-row>
      <ion-col size-xl="20" size="25" *ngFor="let file of folderNames; let i=index;">
        <div class="delete-icon-wrapper">
          <ion-grid>
            <ion-row>
              <ion-col size="100" class="folder-wrapper">
                <!-- <img src="assets/images/default.jpg" (click)="filterByGroupName(file)"
                  > -->
                  <ion-icon name="folder-open-outline" title="Click to View Documents" (click)="filterByGroupName(file)" class="folder-icon"></ion-icon>
              </ion-col>
            </ion-row>
            <ion-row class="ion-justify-content-between">
              <ion-col size="100">
                <div class="folder-name">{{changeString(file)}}</div>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
  <form [hidden]="mediaType != 'upload'">
    <ion-grid>
      <ion-row>
        <ion-col size-xl="20" size="25" style="margin-bottom: 10px;">
          <form class="drop-zone" [formGroup]="uploadDocForm" file-drop (files)="submit($event)">
            <ion-icon class="icon" name="cloud-upload"></ion-icon>
            <input type="file" class="custom-file-input form-control" id="files"
              accept=".png,.jpeg,.pdf,.jpg,.gif,.bmp,.text,.doc,.csv,.docx,.odt" multiple
              (change)="submit($event.target.files)">
            <span class="drag-text">Drag files to upload here</span> <br>
            <label for="files" class="browse-btn">Browse Files</label>
          </form>
        </ion-col>
        <ion-col size-xl="20" size="25" *ngFor="let file of files; let i=index;" [ngClass]="{'display-none': file?.isUploaded }" style="margin-bottom: 10px">
          <div class="delete-icon-wrapper">
            <ion-grid>
              <ion-row>
                <ion-col size="100">
                  <img [src]="file.documentUrl ? file.documentUrl : 'assets/images/default.jpg'">
                </ion-col>
              </ion-row>
              <ion-row class="ion-justify-content-between">
                <ion-col size-xl="80" size-lg="70" size="80">
                  <div class="file-name">{{file.name}}</div>
                </ion-col>
                <ion-col size-xl="10" size-lg="15" size="10" class="ion-text-end ion-no-padding">
                  <ion-icon (click)="removeFile(file,i)" title="Delete File" class="delete-icon" name="close-circle">
                  </ion-icon>
                </ion-col>
              </ion-row>
            </ion-grid>
          </div>
        </ion-col>
      </ion-row>
      <!-- <button (click)="uploadFiles()">Upload</button> -->
    </ion-grid>
  </form>
  <ion-grid [hidden]="mediaType != 'documents'">
    <ion-row>
      <ion-col size-xl="2" size="3">
        <ion-icon name="arrow-back" class="back-button" title="Upload Documents" (click)="goBackToUpload('upload')"></ion-icon>
      </ion-col>
      <ion-col size="97">
        <h3 class="ion-no-margin ion-text-capitalize">{{folderName}}</h3>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size-xl="20" size="25" *ngFor="let file of filteredDocuments; let i=index;">
        <div class="delete-icon-wrapper">
          <ion-grid>
            <ion-row>
              <!-- <ion-col size="100" *ngIf="getFileType(file.name)">
                <img src="assets/images/default.jpg" (click)="downloadDocumentByURl(file.documentUrl)" title="Click To Download PDF">
              </ion-col>
              <ion-col size="100" *ngIf="!getFileType(file.name)">
                <img [src]="file.documentUrl ? file.documentUrl : 'assets/images/default.jpg'" (click)="downloadDocumentByURl(file.documentUrl)" title="Click To Download">
              </ion-col> -->
              <ion-col size="100">
                <img [src]="file?.isImage ? (file?.documentUrl ? file?.documentUrl : 'assets/images/default.jpg') : 'assets/images/default.jpg'" (click)="downloadDocumentByURl(file?.documentUrl)" title="Click To Download">
              </ion-col>
            </ion-row>
            <ion-row class="ion-justify-content-between">
              <ion-col size-xl="80" size-lg="70" size="80">
                <div class="file-name">{{file.name}}</div>
              </ion-col>
              <ion-col size-xl="10" size-lg="15" size="10" class="ion-text-end ion-no-padding">
                <ion-icon (click)="deleteDocument(file, i)" title="Delete File" class="delete-icon" name="close-circle">
                </ion-icon>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ng-template>

<ng-template #faultHistoryTab>
  <ion-grid class="view-details">
    <ion-row class="ion-justify-content-between">
      <!-- <ion-col size="100">
        <div class="title">Fault History</div>
      </ion-col> -->
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Last Repair</ion-text><br />
        <ion-text class="content">{{faultHistory?.description || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Last Repair Date</ion-text><br />
        <ion-text class="content">
          {{faultHistory?.lastRepairDate ? (faultHistory?.lastRepairDate | date: 'dd/MM/yyyy HH:mm') : 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Type</ion-text><br />
        <ion-text class="content">{{faultHistory?.maintType || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Contractor Name</ion-text><br />
        <ion-text class="content">{{faultHistory?.contractorName || 'N/A'}}</ion-text>
      </ion-col>
    </ion-row>
  </ion-grid>
</ng-template>

<ng-template #finalView>
  <ion-grid class="view-details">
    <ion-row class="ion-justify-content-between">
      <ion-col size="100">
        <div class="title">Please review case details and Start Progress when you’re ready</div>
      </ion-col>
      <ion-col size="100">
        <div class="sub-heading">Fault Details</div>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Fault Category</ion-text><br />
        <ion-text class="content">{{getCategoryName() || faultDetails?.fixfloCategory || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Urgency Status</ion-text><br />
        <ion-text class="content">
          {{getLookupValue(faultDetailsForm.controls.urgencyStatus.value, faultUrgencyStatuses) || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Title</ion-text><br />
        <ion-text class="content">{{describeFaultForm.controls.title.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Fault Description</ion-text><br />
        <ion-text class="content">{{faultDetailsForm.controls.notes.value || 'N/A'}}</ion-text>
      </ion-col>
      <ng-container *ngFor="let item of additionalInfoControls; let i = index;">
        <ion-col size-xs="100" size-sm="50" class="header-content">
          <ion-text class="header">Type</ion-text><br />
          <ion-text class="content">{{item.value.label}}</ion-text>
        </ion-col>
        <ion-col size-xs="100" size-sm="50" class="header-content">
          <ion-text class="header">Additional Info</ion-text><br />
          <ion-text class="content">{{item.value.value}}</ion-text>
        </ion-col>
      </ng-container>
      <ion-col size="100" class="border-bottom"></ion-col>
      <ion-col size="100">
        <div class="sub-heading">Reported By</div>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Who reported the fault?</ion-text><br />
        <ion-text class="content">{{getLookupValue(reportedByForm.controls.reportedBy.value, reportedByTypes) || 'N/A'}}
        </ion-text>
      </ion-col>
      <!--  <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Agreement</ion-text><br />
        <ion-text class="content"></ion-text>
      </ion-col> -->
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ng-container *ngIf="reportedByForm.controls.reportedBy.value =='THIRD_PARTY'" >
          <ion-text class="header ion-text-capitalize">{{getLookupValue(reportedByForm.controls.reportedBy.value, reportedByTypes) || 'N/A'}}
          </ion-text><br />
          <ion-text class="content">{{getLookupValue(reportedByForm.controls.reportedById.value, faultReportedByThirdParty) || 'N/A'}}</ion-text>
        </ng-container>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Title</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.title.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Forename</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.forename.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Surname</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.surname.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">E-mail</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.email.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Mobile</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.mobile.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Telephone</ion-text><br />
        <ion-text class="content">{{reportedByForm.controls.alternativeNo.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size="100" class="border-bottom"></ion-col>
      <ion-col size="100">
        <div class="sub-heading">Access Information</div>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Access Information</ion-text><br />
        <ion-text class="content">
          {{(accessInfoForm.controls.isTenantPresenceRequired.value?accessInfoList[0].title:accessInfoList[1].title) || 'N/A'}}
        </ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Is there a vulnerable occupier at this property?</ion-text><br />
        <ion-text class="content">{{accessInfoForm.controls.areOccupiersVulnerable.value?'YES':'NO' || 'N/A'}}
        </ion-text>
      </ion-col>
      <ion-col size-xs="100" size-sm="50" class="header-content">
        <ion-text class="header">Useful Instruction</ion-text><br />
        <ion-text class="content">{{accessInfoForm.controls.tenantNotes.value || 'N/A'}}</ion-text>
      </ion-col>
      <ion-col size="100" class="border-bottom"></ion-col>
    </ion-row>
  </ion-grid>
</ng-template>

<ng-template #caseLogged>
  <ion-grid style="margin-bottom:10px" *ngIf="!showSkeleton">
    <ion-row class="ion-justify-content-start fault-title">
      <ion-col size="auto">
        <h2>
          <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
          {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
            color="success">&gt;</ion-text>
        </h2>
      </ion-col>
      <ion-col size="auto">
        <ion-item class="edit-title" *ngIf="isEditable">
          <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
            (ionBlur)="changeTitle(title.value)"></ion-input>
        </ion-item>
        <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
      </ion-col>
      <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
        <!-- <ion-icon name="create" (click)="editTitle()" style="font-size: 35px;"></ion-icon> -->
        <span class="material-icons" (click)="editTitle()">
          edit
        </span>
      </ion-col>
    </ion-row>
  </ion-grid>
  
  <div *ngIf="showSkeleton">
    <ng-container *ngTemplateOutlet="faultTitleSkeleton"></ng-container>
    <ng-container *ngTemplateOutlet="faultLoggedSkeleton"></ng-container>
  </div> 
 
  <mat-tab-group mat-stretch-tabs mat-align-tabs="start" #caseTabs (selectedIndexChange)="currentSelected($event)" *ngIf="!showSkeleton">
    <mat-tab>
      <ng-template mat-tab-label>
        <div class="label-text" [class.success-border]='isCaseDetailSubmit && faultDetailsForm.valid'
          [class.error-border]='isCaseDetailSubmit && !faultDetailsForm.valid'>Fault Details</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="caseDetails"></ng-container>
      <ng-container *ngTemplateOutlet="additionalInfo"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="pageNo = 2" class="next-button" *ngIf="!faultId" [disabled]="saving">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 1" class="next-button" [disabled]="saving">Next</ion-button>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <div class="label-text" [class.success-border]='isReportedSubmit && reportedByForm.valid'
          [class.error-border]='isReportedSubmit && !reportedByForm.valid'>Reported By</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="reportedBy"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 0" class="next-button"  [disabled]="saving">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 2" class="next-button"  [disabled]="saving">Next</ion-button>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <div class="label-text" [class.success-border]='isAccessInfoSubmit && accessInfoForm.valid'
          [class.error-border]='isAccessInfoSubmit && !accessInfoForm.valid'>Access Information</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="accessInformation"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 1" class="next-button" [disabled]="saving">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 3" class="next-button" [disabled]="saving">Next</ion-button>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <div class="label-text" [class.success-border]='isManageMediaSubmit && files.length !== 0'
          [class.error-border]='isManageMediaSubmit && files.length === 0'>Media / Documents</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="media"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 2" class="next-button" [disabled]="saving">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 4" class="next-button" [disabled]="saving">Next</ion-button>
      </div>
    </mat-tab>
    <mat-tab *ngIf="faultId">
      <ng-template mat-tab-label>
        <div class="label-text">Fault History</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="faultHistoryTab"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 3" class="next-button" [disabled]="saving">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 5" class="next-button" [disabled]="saving">Next</ion-button>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <div class="label-text">Review</div>
      </ng-template>
      <ng-container *ngTemplateOutlet="finalView"></ng-container>
      <div class="action-btn-group">
        <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving || submitting || progressing || proceeding">Cancel</ion-button>
        <ion-button class="save-button" (click)="saveForLater()" [disabled]="submitting || proceeding">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 4" class="next-button" *ngIf="faultId" [disabled]="saving || submitting || progressing || proceeding">Back</ion-button>
        <ion-button (click)="caseTabs.selectedIndex = 3" class="next-button" *ngIf="!faultId" [disabled]="saving || submitting || progressing || proceeding">Back</ion-button>
        <ion-button (click)="goToNextStage()" class="next-button" *ngIf="faultId && faultDetails?.stage !== FAULT_STAGES.FAULT_LOGGED" [disabled]="saving || submitting || progressing || proceeding">Next</ion-button>
        <ion-button class="submit-button" (click)="createAFault()" *ngIf="!faultId" [disabled]="saving">Submit<ion-icon *ngIf="submitting" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button class="save-button" (click)="startProgress()"
          *ngIf="faultId && faultDetails?.status == 1 && reportedByForm.value.reportedById" [disabled]="saving">Start
          Progress<ion-icon *ngIf="submitting" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button class="save-button" (click)="proceedToNextStage()" *ngIf="faultId && faultDetails?.status != 1" 
         [disabled]="(cliNotification && (cliNotification.responseReceived == null || cliNotification.responseReceived?.isAccepted == null)) || saving || submitting || faultDetails?.isClosed">
          Proceed<ion-icon *ngIf="proceeding" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
        <ion-button class="save-button" (click)="reOpenFault()" *ngIf="faultId && faultDetails?.status == 12" [disabled]="saving || submitting || proceeding">Re-open
        </ion-button>
      </div>
    </mat-tab>
  </mat-tab-group>
</ng-template>

<ng-template #caseQualification>
    <ion-card class="ion-no-margin">
      <ng-container *ngIf="faultDetails && (faultDetails?.stage === 'FAULT_QUALIFICATION' || stepper?.selectedIndex == 1)">
        <ion-grid style="margin-bottom:10px" *ngIf="!showSkeleton">
          <ion-row class="ion-justify-content-start fault-title">
            <ion-col size="auto">
              <h2>
                <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
                {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
                  color="success">&gt;</ion-text>
              </h2>
            </ion-col>
            <ion-col size="auto">
              <ion-item class="edit-title" *ngIf="isEditable">
                <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
                  (ionBlur)="changeTitle(title.value)"></ion-input>
              </ion-item>
              <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
            </ion-col>
            <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
              <span class="material-icons" (click)="editTitle()">
                edit
              </span>
            </ion-col>
          </ion-row>
        </ion-grid>
        <div *ngIf="showSkeleton">
          <ng-container *ngTemplateOutlet="faultTitleSkeleton"></ng-container>
        </div>
        <app-fault-qualification [faultDetails]="faultDetails" [faultCategories]="faultCategories" [propertyDetails]="propertyDetails"  (btnAction)="_childComponentHandler($event)" [describeFaultForm]="describeFaultForm"></app-fault-qualification>
      </ng-container>
  </ion-card>
</ng-template>

<ng-template #landlordInstructions>
  <ng-container>
    <ion-grid style="margin-bottom:10px" *ngIf="!showSkeleton">
      <ion-row class="ion-justify-content-start fault-title">
        <ion-col size="auto">
          <h2>
            <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
            {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
              color="success">&gt;</ion-text>
          </h2>
        </ion-col>
        <ion-col size="auto">
          <ion-item class="edit-title" *ngIf="isEditable">
            <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
              (ionBlur)="changeTitle(title.value)"></ion-input>
          </ion-item>
          <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
        </ion-col>
        <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
          <span class="material-icons" (click)="editTitle()">
            edit
          </span>
        </ion-col>
      </ion-row>
    </ion-grid>
    <div *ngIf="showSkeleton">
      <ng-container *ngTemplateOutlet="faultTitleSkeleton"></ng-container>
    </div>
    <ion-grid>
      <ion-row *ngIf="!showSkeleton">
        <!-- <ion-col offset-xl="25" size-xl="50" offset ="0" size="100">  -->
        <ion-col offset-xl="20" size-xl="60" offset="0" size="100">
          <div class="landlord-instructions">
            <div class="banner" *ngIf="!cliNotification">
              <h2 class="banner-heading">Based on your preferences, we suggest:</h2>
              <ion-button color="{{(suggestedAction == 'AGENT_OF_NECESSITY') ? 'danger' : 'success'}}"
                class="icon-button" (click)="setUserAction(suggestedAction)"
                fill="{{(userSelectedActionControl.value == suggestedAction) ? 'solid' :'outline'}}">
                {{getLookupValue(suggestedAction, landlordInstructionTypes)}}
                <ion-icon name="checkmark-circle-outline" *ngIf="(userSelectedActionControl.value == suggestedAction)">
                </ion-icon>
              </ion-button>
              <h6 class="ownRepair" *ngIf="(isMatch === false && suggestedAction == 'DOES_OWN_REPAIRS')">
                Landlord owned Repair Category does not match the Fault Category</h6>
  
              <h6 class="banner-title">Want to proceed in a different way? Choose one of the following instead:</h6>
              <ion-grid>
                <ion-row class="ion-justify-content-center">
                  <ng-container *ngFor="let instruction of landlordInstructionTypes">
                    <div *ngIf="suggestedAction!= instruction.index">
                      <ion-button color="{{instruction.index != 'AGENT_OF_NECESSITY' ? 'success' : 'danger'}}"
                        class="action-btn" expand="block"
                        fill="{{userSelectedActionControl.value == instruction.index ? 'solid' :'outline'}}"
                        (click)="setUserAction(instruction.index)">
                        {{instruction.value}}
                        <ion-icon name="checkmark-circle-outline" class="check-icon"
                          *ngIf="(userSelectedActionControl.value == instruction.index)"></ion-icon>
                      </ion-button>
                      <h6 class="ownRepair" *ngIf="(instruction.index == 'DOES_OWN_REPAIRS' && isMatch === false )">
                        Landlord owned Repair Category does not match the Fault Category</h6>
                    </div>
                  </ng-container>
                </ion-row>
              </ion-grid>
            </div>
            <div *ngIf="cliNotification">
              <div class="banner">
                <div class="ion-text-left">
                  <b>{{cliNotification?.chaseTemplateCode}} {{cliNotification?.firstEmailSentAt | date: 'dd/MM/yyyy HH:mm' }}</b>
                </div>
                <h2 class="banner-heading">
                  {{cliNotification && cliNotification?.responseReceived ? 'Response Received': 
                  (cliNotification?.responseReceived === null && cliNotification?.allowedNumberOfChases === cliNotification?.numberOfChasesDone && !cliNotification?.hoursLeft?'No response':'Awaiting response')}}
                </h2>
                <h6 class="banner-title">Here’s the action you chose:</h6>
                <ion-button color="success" class="icon-button">
                  {{getLookupValue(cliNotification?.faultStageAction, landlordInstructionTypes)}}
                  <ion-icon name="checkmark-circle-outline"></ion-icon>
                </ion-button>
                
                <ng-container *ngIf="cliNotification && cliNotification?.responseReceived && cliNotification?.recipientType === 8">
                  <h6 class="banner-title response-recived"><ion-icon name="ellipse" class="response-circle"></ion-icon> Response received from Landlord {{cliNotification?.chaseTemplateCode}} {{cliNotification?.firstEmailSentAt | date: 'dd/MM/yyyy HH:mm' }} </h6>
                </ng-container>
  
                <ng-container *ngIf="cliNotification && !cliNotification?.responseReceived">
                  <h6 class="banner-title"
                    [ngClass]="cliNotification?.responseReceived === null && cliNotification?.allowedNumberOfChases === cliNotification?.numberOfChasesDone && !cliNotification?.hoursLeft?'no-response':'awaiting-response'"
                  >
                    <ion-icon name="ellipse" class="response-circle"></ion-icon> {{cliNotification?.responseReceived === null && cliNotification?.allowedNumberOfChases === cliNotification?.numberOfChasesDone && !cliNotification?.hoursLeft?'No response':'Awaiting response'}} received from Landlord</h6>
                  <h6 class="banner-title" *ngIf="!faultDetails?.isEscalated" >{{cliNotification.allowedNumberOfChases === cliNotification.numberOfChasesDone?'Escalation':'Next chase'}} due:
                    {{cliNotification ? (cliNotification.nextChaseDueAt | date: 'dd MMM yyyy - HH:mm') : ''}}
                  </h6>
                </ng-container>
              </div>
              <div class="question-answer" *ngFor="let question of cliNotification?.questions">
                <ng-container *ngIf="question?.entityType == fileIds.FIX_A_FAULT">
                  <h6>{{question?.qtext}}</h6>
                  <ion-grid>
                    <ion-row class="ion-justify-content-center">
                      <ng-container *ngFor="let data of question?.options">
                        <ion-button color="success" class="action-btn option"
                        fill="{{data?.value == cliNotification?.responseReceived?.isAccepted ? 'solid' :'outline'}}"
                        (click)="questionAction(data)">{{data.text}}</ion-button>
                      </ng-container>
                      <ng-container *ngIf="cliNotification?.templateCode === 'LR-L-E' && faultDetails?.isClosed">
                        <ion-button color="success" class="action-btn option"
                        fill="solid">Close Fault</ion-button>
                      </ng-container>
                    </ion-row>
                  </ion-grid>
                  <h6 *ngIf="cliNotification?.faultStageAction === 'DOES_OWN_REPAIRS' && cliNotification?.responseReceived?.isAccepted === false">
                    <ion-text color="danger">Please select an appropriate action.</ion-text>
                  </h6>
                  <div class="border-bottom"></div>
                </ng-container>
              </div>
              <div class="question-answer" *ngIf="cliNotification && cliNotification?.responseReceived == null && (cliNotification.allowedNumberOfChases === cliNotification.numberOfChasesDone) 
              && cliNotification?.notificationStatus !== 7 && !faultDetails?.isEscalated && faultDetails?.status !== 10 && faultDetails?.status !== 12">
                <h6>
                  <ion-text color="danger">Please note:</ion-text>
                  The fault will be <i>escalated</i> automatically if the Landlord doesn't respond within {{cliNotification?.hoursLeft}}.
                </h6>
                <div class="border-bottom"></div>
              </div>
              <div class="question-answer"
                *ngIf="cliNotification && cliNotification?.responseReceived?.isAccepted === true && (cliNotification?.templateCode === 'LR-L-E' || cliNotification?.templateCode === 'LC-L-E')">
                <h4 claas="ion-text-center">Next Step:</h4>
                <ion-button color="success" class="action-btn" fill="{{faultDetails.estimatedVisitAt != null ? 'solid' : 'outline'}}" (click)="llContractor(); $event.stopPropagation();">
                  {{faultDetails?.landlordOwnContractor?.landlordOwnContractorId!==null?"View/Edit Contractor details":"Add Contractor Details"}}</ion-button>
                <h6 *ngIf="faultDetails?.landlordOwnContractor?.landlordOwnContractorId === null && !faultDetails?.isEscalated">
                  <ion-text color="danger">Please note: </ion-text>
                  <span>
                    The fault will be <i>escalated</i> if the contractor's details including the scheduled date & time of the repair have not been added in the next 6/24 hours
                  </span>
                </h6>
                <h6 *ngIf="faultDetails?.isEscalated" >
                  <ion-text color="danger">Please note: </ion-text>Fault Escalated - PM to decide the next steps
                </h6>
                <div class="border-bottom"></div>
              </div>

              <div class="question-answer ion-text-center" 
                *ngIf="(cliNotification?.responseReceived?.isAccepted === false || faultDetails?.isEscalated) && cliNotification?.notificationStatus !== 7 && cliNotification?.responseReceived?.isAccepted != true">
                <h4 claas="ion-text-center">Next Step:</h4>
                <h6 *ngIf="faultDetails.urgencyStatus == 3">
                  <ion-text color="danger">Please note: </ion-text>Fault Escalated - PM to decide the next steps
                </h6>
                <h6 *ngIf="faultDetails.urgencyStatus != 3" >
                  <ion-text color="danger">Please note: </ion-text>Fault Escalated - Please proceed with the following action:
                  <ion-grid>
                    <ion-row class="ion-justify-content-center">                    
                      <ion-button color="danger" expand="block" class="action-btn"
                        fill="{{userSelectedActionControl.value == 'AGENT_OF_NECESSITY' ? 'solid' :'outline'}}" (click)="setUserAction('AGENT_OF_NECESSITY')">
                        {{getLookupValue('AGENT_OF_NECESSITY', landlordInstructionTypes)}}
                        <ion-icon name="checkmark-circle-outline" class="check-icon" *ngIf="(userSelectedActionControl.value == 'AGENT_OF_NECESSITY')"></ion-icon>
                      </ion-button>
                    </ion-row>
                  </ion-grid>
                </h6>
                <div class="border-bottom"></div>
              </div>
  
              <div class="question-answer"
                *ngIf="cliNotification?.recipientType === 8 && faultDetails?.isOverrideCommunicationPreference === true
                && cliNotification?.notificationStatus === 7 && cliNotification?.responseReceived === null">
                <h4 claas="ion-text-center">Next Step:</h4>  
                <h6>
                  <ion-text color="danger">Please note: </ion-text>
                  <span>This Fault is <i>escalated</i> as Landlord Override communication option is activated. 
                    Please respond yourself or forward to Landlord for them to take an action by clicking here</span>
                </h6>
                <ion-button color="success" class="action-btn" fill="solid" (click)="viewNotification(); $event.stopPropagation();">
                  View Notification</ion-button>
                <div class="border-bottom"></div>
              </div>
              
              <div class="question-answer" [hidden]="(cliNotification?.responseReceived?.isAccepted === false || faultDetails?.isEscalated) 
                    && cliNotification?.notificationStatus !== 7 && faultDetails.urgencyStatus != 3" >
                <h6 class="banner-title">Want to proceed in a different way? Choose one of the following instead:</h6>
                <ion-grid>
                  <ion-row class="ion-justify-content-center">
                    <ng-container *ngFor="let instruction of landlordInstructionTypes">
                      <div *ngIf="oldUserSelectedAction != instruction.index">
                        <ion-button color="{{instruction.index != 'AGENT_OF_NECESSITY' ? 'success' : 'danger'}}"
                          expand="block" class="action-btn"
                          fill="{{userSelectedActionControl.value == instruction.index ? 'solid' :'outline'}}"
                          (click)="setUserAction(instruction.index)">
                          {{instruction.value}}
                          <ion-icon name="checkmark-circle-outline" class="check-icon"
                            *ngIf="(userSelectedActionControl.value == instruction.index)"></ion-icon>
                        </ion-button>
                        <h6 class="ownRepair" *ngIf="(isMatch === false && instruction.index == 'DOES_OWN_REPAIRS')">
                          Landlord owned Repair Category does not match the Fault Category</h6>
                      </div>
                    </ng-container>
                  </ion-row>
                </ion-grid>
              </div>
            </div>
  
            <div class="contractor-selection">
              <form [formGroup]="landlordInstFrom">
                <ion-grid>
                  <ion-row>
                    <ion-col size="50">
                      <!-- <ion-item>
                        <ion-label position="floating">Select Contractor</ion-label>
                        <ion-select interface="popover" formControlName="contractorId">
                          <ion-select-option>Choose</ion-select-option>
                        </ion-select>
                      </ion-item> -->
                      <ion-item>
                        <ion-label position="floating">Select Contractor</ion-label>
                        <ion-input type="text" debounce="1000" (ionInput)="onSearchChange($event)"
                          formControlName='contractor'
                          [disabled]="!(userSelectedActionControl.value == 'GET_AN_ESTIMATE' 
                          || userSelectedActionControl.value == 'OBTAIN_AUTHORISATION'
                          || userSelectedActionControl.value == 'AGENT_OF_NECESSITY'
                          || userSelectedActionControl.value == 'PROCEED_WITH_WORKSORDER')"
                         >
                        </ion-input>
                      </ion-item>
                      <ion-list class="contractor-list" *ngIf="resultsAvailable">
                        <ion-item *ngFor="let result of (selectedContractor | async)?.data" (click)="contractorSelected(result)" button
                          style="font-size: 13px !important; ">
                          <span>
                            <i class="propcoicon no-background propcoicon-contractor"
                              style="background: transparent;"></i>
                          </span>&nbsp;
                          <label style="color: var(--ion-color-step-200);padding-right: 5px;">{{result.fullName}}&nbsp;
                            <span style="color: var(--ion-color-step-1000);padding-right: 5px;">{{result.reference}}</span>&nbsp;
                            <span class="text-color-lightgreen" style="color: var(--ion-color-primary);padding-right: 5px;">{{result.status}}</span>&nbsp;  
                          </label>                        
                        </ion-item>
                      </ion-list>
                      <div *ngIf="landlordInstFrom.get('contractor').hasError('invalidContractor') && landlordInstFrom.get('contractor').touched" class="contractor-error-message">
                        {{landlordInstFrom.get('contractor').errors.message}}</div>
                    </ion-col>
                    <ion-col size="50">
                      <ion-item>
                        <ion-label position="stacked">Confirmed Estimate</ion-label>
                        <input currencyMask formControlName="confirmedEstimate"
                          [disabled]="!(userSelectedActionControl.value == 'GET_AN_ESTIMATE' 
                          || userSelectedActionControl.value == 'OBTAIN_AUTHORISATION'
                          || userSelectedActionControl.value == 'AGENT_OF_NECESSITY'
                          || userSelectedActionControl.value == 'PROCEED_WITH_WORKSORDER')"
                          #estimate (blur)="showRefreshPopup(estimate.value); onBlurCurrency(landlordInstFrom.controls.confirmedEstimate.value, landlordInstFrom)"/>
                      </ion-item>
                    </ion-col>
                    <ion-col size="100">
                      <ion-item>
                        <ion-label position="stacked">Notes</ion-label>
                        <ion-textarea placeholder="Enter more information here..." formControlName="estimationNotes"
                          [disabled]="!(userSelectedActionControl.value == 'GET_AN_ESTIMATE' 
                          || userSelectedActionControl.value == 'OBTAIN_AUTHORISATION'
                          || userSelectedActionControl.value == 'AGENT_OF_NECESSITY'
                          || userSelectedActionControl.value == 'PROCEED_WITH_WORKSORDER')"
                          rows=1 auto-grow="true"></ion-textarea>
                      </ion-item>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </form>
            </div>
  
            <div class="landlord-preferences">
              <ion-grid class="view-details" style="width: 100%;">
                <ion-row class="ion-justify-content-between">
                  <h2 class="banner-heading">Landlord preferences and other information </h2>
  
                  <ion-col size-xs="100" class="header-content">
                    <ion-text class="header">Contractor Instructions</ion-text><br />
                    <ion-text class="content">
                      {{landlordDetails?.doesOwnRepairs ? "Landlord does their own repairs" : "Agent's own contractor"}}
                    </ion-text>
                    <ion-button color="success" fill="outline" (click)="presentRepairCategories($event)"
                      *ngIf="landlordDetails?.doesOwnRepairs">Repair Categories</ion-button>
                  </ion-col>
                  <ion-col size-xs="100" size-sm="50" class="header-content">
                    <ion-text class="header">Branch holds management keys?</ion-text><br />
                    <ion-text class="content">{{faultDetails?.doesBranchHoldKeys ? 'Yes' : 'No'}}</ion-text>
                  </ion-col>
                  <ion-col size-xs="100" size-sm="50" class="header-content">
                    <ion-text class="header">Expenditure Limit</ion-text><br />
                    <ion-text class="content">{{propertyDetails?.expenditureLimit | currency: '£'}}</ion-text>
                  </ion-col>
                  <ion-col size-xs="100" size-sm="50" class="header-content">
                    <ion-text class="header">Vulnerable Tenant</ion-text><br />
                    <ion-text class="content">{{accessInfoForm?.controls?.areOccupiersVulnerable?.value ? 'Yes' : 'No'}}
                    </ion-text>
                  </ion-col>
                  <ion-col size-xs="100" size-sm="50" class="header-content">
                    <ion-text class="header">Tenant allows access</ion-text><br />
                    <ion-text class="content">{{accessInfoForm?.controls?.isTenantPresenceRequired?.value ? 'Yes' : 'No'}}
                    </ion-text>
                  </ion-col>
                  <ion-col size="100" class="border-bottom"></ion-col>
                </ion-row>
              </ion-grid>
            </div>
            <div class="preferred-supplier">
              <h2>Preferred Suppliers</h2>
              <table>
                <tr>
                  <th>REF</th>
                  <th>SUPPLIER / CONTRACTOR</th>
                  <th>TRADE</th>
                </tr>
                <tr *ngFor="let supplier of preferredSuppliers">
                  <td>{{supplier.reference}}</td>
                  <td>{{supplier.company}}</td>
                  <td>{{supplier.occupation}}</td>
                </tr>
                <tr *ngIf="!preferredSuppliers?.length">
                  <td colspan="12" class="ion-text-center">No data to display</td>
                </tr>
              </table>
            </div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
    
  </ng-container>
    <ion-grid *ngIf="showSkeleton">
      <ion-row>
        <ion-col offset-xl="20" size-xl="60" offset="0" size="100">
          <!-- <ng-container *ngTemplateOutlet="arrangingContractorSkeleton"></ng-container> -->
          <ng-container *ngTemplateOutlet="notificationSkeleton"></ng-container>
          <ng-container *ngTemplateOutlet="landlordInstructionsSkeleton"></ng-container>
        </ion-col>
      </ion-row>
    </ion-grid>

  <div class="action-btn-group">
    <ion-button (click)="goTolistPage()" class="cancel-button" [disabled]="saving || proceeding">Cancel</ion-button>
    <ion-button (click)="goToLastStage()" [disabled]="saving || proceeding">Back</ion-button>
    <ion-button (click)="goToNextStage()" *ngIf="faultDetails?.stage !== FAULT_STAGES.LANDLORD_INSTRUCTION" [disabled]="saving || proceeding">Next</ion-button>
    <ion-button class="save-button" (click)="saveForLater()" [disabled]="proceeding">Save for later<ion-icon *ngIf="saving" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
    <ion-button class="submit-button" (click)="proceedToNextStage()" *ngIf="faultId" [disabled]="saving || faultDetails?.isClosed">Proceed<ion-icon *ngIf="proceeding" name="refresh" class="rotating submit-loader"></ion-icon></ion-button>
  </div>
</ng-template>

<ng-template #arrangingContractor>
  <ion-card class="ion-no-margin">
    <ng-container *ngIf="faultDetails && (faultDetails.stage === 'ARRANGING_CONTRACTOR' || stepper?.selectedIndex == 3) && landlordsOfproperty">
      <ion-grid style="margin-bottom:10px" *ngIf="!showSkeleton">
        <ion-row class="ion-justify-content-start fault-title">
          <ion-col size="auto">
            <h2>
              <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
              {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
                color="success">&gt;</ion-text>
            </h2>
          </ion-col>
          <ion-col size="auto">
            <ion-item class="edit-title" *ngIf="isEditable">
              <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
                (ionBlur)="changeTitle(title.value)"></ion-input>
            </ion-item>
            <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
          </ion-col>
          <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
            <span class="material-icons" (click)="editTitle()">
              edit
            </span>
          </ion-col>
        </ion-row>
      </ion-grid>
      <div *ngIf="showSkeleton">
        <ng-container *ngTemplateOutlet="faultTitleSkeleton"></ng-container>
      </div>
      <app-arranging-contractor [faultDetails]="faultDetails" 
      (btnAction)="_childComponentHandler($event)" 
      [leadTenantId]="leadTenantId" 
      [propertyLandlords]="landlordsOfproperty" 
      [quoteDocuments]="quoteDocuments" 
      [propertyDetails]="propertyDetails"
      [categoryName]="getCategoryName()"
      [MAX_DOC_UPLOAD_LIMIT]="MAX_DOC_UPLOAD_LIMIT" 
      [describeFaultForm]="describeFaultForm"></app-arranging-contractor>
    </ng-container>
  </ion-card>
</ng-template>

<ng-template #jobCompletion>
  <ion-card class="ion-no-margin">
    <ng-container *ngIf="faultDetails && (faultDetails.stage === 'JOB_COMPLETION' || stepper?.selectedIndex == 4)">
      <ion-grid style="margin-bottom:10px">
        <ion-row class="ion-justify-content-start fault-title">
          <ion-col size="auto">
            <h2>
              <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
              {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
                color="success">&gt;</ion-text>
            </h2>
          </ion-col>
          <ion-col size="auto">
            <ion-item class="edit-title" *ngIf="isEditable">
              <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
                (ionBlur)="changeTitle(title.value)"></ion-input>
            </ion-item>
            <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
          </ion-col>
          <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
            <span class="material-icons" (click)="editTitle()">
              edit
            </span>
          </ion-col>
        </ion-row>
      </ion-grid>
      <app-job-completion 
      [faultDetails]="faultDetails" 
      (btnAction)="_childComponentHandler($event)"
      [quoteDocuments]="quoteDocuments"
      [propertyDetails]="propertyDetails"
      [categoryName]="getCategoryName()"
      [MAX_DOC_UPLOAD_LIMIT]="MAX_DOC_UPLOAD_LIMIT"></app-job-completion>
    </ng-container>
  </ion-card>
</ng-template>

<ng-template #payment>
  <ion-card class="ion-no-margin">
    <ng-container *ngIf="faultDetails && (faultDetails.stage === 'PAYMENT' || stepper?.selectedIndex == 5)">
      <ion-grid style="margin-bottom:10px">
        <ion-row class="ion-justify-content-start fault-title">
          <ion-col size="auto">
            <h2>
              <ion-text *ngIf="faultId">{{faultDetails?.reference || ''}} </ion-text>
              {{categoryMap.get(describeFaultForm.controls['category'].value) || faultDetails?.fixfloCategory}} <ion-text
                color="success">&gt;</ion-text>
            </h2>
          </ion-col>
          <ion-col size="auto">
            <ion-item class="edit-title" *ngIf="isEditable">
              <ion-input #title [value]="describeFaultForm.controls['title'].value" style="font-size:24px;padding-bottom:0"
                (ionBlur)="changeTitle(title.value)"></ion-input>
            </ion-item>
            <h2 *ngIf="!isEditable">{{describeFaultForm.controls['title'].value}} </h2>
          </ion-col>
          <ion-col size="auto" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
            <span class="material-icons" (click)="editTitle()">
              edit
            </span>
          </ion-col>
        </ion-row>
      </ion-grid>
      <app-payment
      [faultDetails]="faultDetails" 
      (btnAction)="_childComponentHandler($event)"
      [quoteDocuments]="quoteDocuments"
      [propertyDetails]="propertyDetails"
      [categoryName]="getCategoryName()"></app-payment>
    </ng-container>
  </ion-card>
</ng-template>

<ion-content id="fault-details">
  <ion-grid *ngIf="pageNo===1 && propertyDetails?.propertyId">
    <ion-row>
      <ion-col>
        <h2 class="heading">Log a fault</h2>
        <h2>
          What do you want to report in
          <b>
            {{ propertyDetails?.address?.addressLine1 ?
            propertyDetails?.address?.addressLine1 + ',' : ''}} {{
            propertyDetails?.address?.addressLine2 ?
            propertyDetails?.address?.addressLine2 + ',' : ''}} {{
            propertyDetails?.address?.locality ? propertyDetails?.address?.locality +
            ',' : ''}} {{ propertyDetails?.address?.postcode }} ?
          </b>
        </h2>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size-xl="20" size="25" *ngFor="let item of faultCategories">
        <div class="block" [class.active]="item.index == describeFaultForm?.controls?.category?.value"
          (click)="goToPage(2);setCategory(item.index)">
          <!-- <img [src]="item.imgPath" /> -->
          <h4 class="center">{{item.value}}</h4>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-grid *ngIf="pageNo===2">
    <ion-row>
      <ion-col>
        <h2 class="heading">Log a fault</h2>
        <h2>
          Describe the issue with
          <b>{{getLookupValue(describeFaultForm?.controls?.category?.value, faultCategories)}}</b> in
          <b>
            {{ propertyDetails?.address?.addressLine1 ?
            propertyDetails?.address?.addressLine1 + ',' : ''}} {{
            propertyDetails?.address?.addressLine2 ?
            propertyDetails?.address?.addressLine2 + ',' : ''}} {{
            propertyDetails?.address?.locality ? propertyDetails?.address?.locality +
            ',' : ''}} {{ propertyDetails?.address?.postcode }} ?
          </b>
        </h2>
        <div class="priority-heading">Select the priority</div>
        <ion-button (click)="setUrgencyStatus(3)" class="non-urgent-btn"
          [class.urgency-selected]="faultDetailsForm.controls.urgencyStatus.value ===3">Non urgent</ion-button>
        <ion-button (click)="setUrgencyStatus(2)" class="urgent-btn"
          [class.urgency-selected]="faultDetailsForm.controls.urgencyStatus.value===2">Urgent</ion-button>
        <ion-button (click)="setUrgencyStatus(1)" class="emergency-btn"
          [class.urgency-selected]="faultDetailsForm.controls.urgencyStatus.value===1">Emergency</ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

  <form class="panel-block-normal propco-form" *ngIf="pageNo===2" [formGroup]="describeFaultForm">
    <ion-grid>
      <ion-row class="main-row">
        <ion-col size="100" class="col1">
          <ion-item>
            <ion-label position="floating">Title<ion-text class="mandatory">*</ion-text>
            </ion-label>
            <ion-input type="text" formControlName="title"> </ion-input>
          </ion-item>
          <app-validation-message [control]="describeFaultForm.controls.title"></app-validation-message>
        </ion-col>
        <ion-col size="100" class="col2">
          <ion-button (click)="goTolistPage()" class="cancel-button">Cancel</ion-button>
          <ion-button (click)="goToPage(1)" *ngIf="!faultId">Back</ion-button>
          <ion-button (click)="goToPage(3)" [disabled]="!describeFaultForm.valid">Next</ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>

  <ng-container *ngIf="pageNo===3">
    <ion-grid>
      <ion-row>
        <ion-col size="50">
          <h2 class="heading">{{faultId ? 'Fault Summary' : 'Log a fault'}}</h2>
        </ion-col>
        <ion-col size="50">
          <h2 class="heading-initial">
            <span *ngIf="!faultId">Initial Issue</span>
            <span *ngIf="faultId">
              <!-- {{faultDetails?.isEscalated ? 'Escalation' : getLookupValue(faultDetails?.status, faultStatuses)}} &nbsp; -->
              {{faultDetails?.isClosed || (faultDetails?.isClosed && faultDetails?.isEscalated) ? 'Closed' : 
              (faultDetails?.isEscalated ? 'Escalation' : getLookupValue(faultDetails?.status, faultStatuses))  }} &nbsp;
              <img src="assets/images/fault-categories/escalation.svg" *ngIf="faultDetails?.isEscalated" />
            </span>
          </h2>
        </ion-col>
        <ion-col size="100">
          <ion-card class="ion-no-margin" id="property-details-card">
            <app-property-details [propertyDetails]="propertyDetails" [files]="files" [parentForm]="uploadDocForm"
              (getUploadedFile)="getUploadedFile($event)" [hmoDetails]="propertyHMODetails"
              [urgencyStatus]="faultDetailsForm.controls.urgencyStatus.value" [faultId]="faultId? faultId : ''"
              [createdAt]="faultDetails?.createdAt? faultDetails?.createdAt : ''" [communicationPreference]="faultDetails?.isOverrideCommunicationPreference"
              [dppRepairDetails]="landlordDppRepairDetails" (getStatus)="getStatus($event)">
            </app-property-details>
            <!-- <app-property-skeleton *ngIf="!propertyDetails"></app-property-skeleton> -->
          </ion-card>
        </ion-col>
        <ion-col size="100">
          <mat-horizontal-stepper #stepper labelPosition="bottom" [selectedIndex]="currentStepperIndex">
            <mat-step  [completed]="stepper.selectedIndex > 0">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 0"> -->
              <ng-container *ngTemplateOutlet="caseLogged"></ng-container>
              <ng-template matStepLabel>Fault Logged</ng-template>
            </mat-step>
            <mat-step [aria-labelledby]="faultDetails && faultDetails?.stageIndex < 1 ? 'disabled_stepper_step':''" [completed]="stepper.selectedIndex > 1">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 1"> -->
              <ng-container *ngTemplateOutlet="caseQualification"></ng-container>
              <ng-template matStepLabel>Fault Qualification</ng-template>
            </mat-step>
            <mat-step [aria-labelledby]="faultDetails && faultDetails?.stageIndex < 2 ? 'disabled_stepper_step':''" [completed]="stepper.selectedIndex > 2">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 2"> -->
              <ng-container *ngTemplateOutlet="landlordInstructions"></ng-container>
              <ng-template matStepLabel>Landlord Instructions</ng-template>
            </mat-step>
            <mat-step [aria-labelledby]="faultDetails && faultDetails?.stageIndex < 3 ? 'disabled_stepper_step':''" [completed]="stepper.selectedIndex > 3">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 3"> -->
              <ng-container *ngTemplateOutlet="arrangingContractor"></ng-container>
              <ng-template matStepLabel>Arranging Contractor</ng-template>
            </mat-step>
            <mat-step [aria-labelledby]="faultDetails && faultDetails?.stageIndex < 4 ? 'disabled_stepper_step':''" [completed]="stepper.selectedIndex > 4">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 4"> -->
              <ng-container *ngTemplateOutlet="jobCompletion"></ng-container>
              <ng-template matStepLabel>Job Completion</ng-template>
            </mat-step>
            <mat-step [aria-labelledby]="faultDetails && faultDetails?.stageIndex < 5 ? 'disabled_stepper_step':''" [completed]="stepper.selectedIndex > 5">
              <!-- <mat-step aria-labelledby="disabled_stepper_step" [completed]="stepper.selectedIndex > 5"> -->
              <ng-container *ngTemplateOutlet="payment"></ng-container>
              <ng-template matStepLabel>Payment</ng-template>
            </mat-step>
          </mat-horizontal-stepper>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-container>

</ion-content>

<ng-template #faultLoggedSkeleton>
  <ion-grid>
    <ion-row class="tab-skeleton">
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="16.66"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
    </ion-row>

    <ion-row class="input-skeleton">
      <ion-col size="30"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
      <ion-col size="70"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
    </ion-row>

    <ion-row class="input-skeleton">
      <ion-col size-xl="50" size="100">
        <ion-grid class="additional-info-container">
          <ion-row>
            <ion-col size="30"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
            <ion-col size="60"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
            <ion-col size="10"><ion-skeleton-text animated></ion-skeleton-text></ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>
    </ion-row>

    <div class="action-btn-group">
      <ion-skeleton-text animated></ion-skeleton-text>
      <ion-skeleton-text animated></ion-skeleton-text>
      <ion-skeleton-text animated></ion-skeleton-text>
    </div>
  </ion-grid>
</ng-template>

<ng-template #arrangingContractorSkeleton>
  <div class="custom-skeleton">
    <div class="skeleton-content">
      <div class="forms-container" >
        <ion-grid>
          <div class="forms-block">
            <ion-row>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="100">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="50">
                <p class="icons">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
              <ion-col size="100">
                <p class="icons"  style="height: 70px;border-radius: 10px;">
                  <ion-skeleton-text class="header" animated style="width: 100%"></ion-skeleton-text>
                </p>
              </ion-col>
            </ion-row>
          </div>
        </ion-grid>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #landlordInstructionsSkeleton>
  <ion-grid class="landlord-instructions">
    <ion-row class="ll-skeleton input-skeleton">
      <ion-col>
        <div class="contractor-selection">
            <ion-grid>
              <ion-row>
                <ion-col size="50">
                  <ion-skeleton-text animated></ion-skeleton-text>
                </ion-col>
                <ion-col size="50">
                  <ion-skeleton-text animated></ion-skeleton-text>
                </ion-col>
                <ion-col size="100">
                  <ion-skeleton-text animated></ion-skeleton-text>
                </ion-col>
              </ion-row>
            </ion-grid>
        </div>
        <div class="landlord-preferences">
          <ion-grid class="view-details" style="width: 100%;">
            <ion-row>
              <ion-col size="70">
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size-xs="100" class="header-content">
                <ion-skeleton-text animated></ion-skeleton-text><br />
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size-xs="100" size-sm="50" class="header-content">
                <ion-skeleton-text animated></ion-skeleton-text><br />
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size-xs="100" size-sm="50" class="header-content">
                <ion-skeleton-text animated></ion-skeleton-text><br />
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size-xs="100" size-sm="50" class="header-content">
                <ion-skeleton-text animated></ion-skeleton-text><br />
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size-xs="100" size-sm="50" class="header-content">
                <ion-skeleton-text animated></ion-skeleton-text><br />
                <ion-skeleton-text animated></ion-skeleton-text>
              </ion-col>
              <ion-col size="100" class="border-bottom"></ion-col>
            </ion-row>
          </ion-grid>
        </div>
        <div class="preferred-supplier">
          <ion-row>
            <ion-col size="70">
              <ion-skeleton-text animated></ion-skeleton-text>
            </ion-col>
          </ion-row>
          <table>
            <tr>
              <th><ion-skeleton-text animated></ion-skeleton-text></th>
              <th><ion-skeleton-text animated></ion-skeleton-text></th>
              <th><ion-skeleton-text animated></ion-skeleton-text></th>
            </tr>
            <tr>
              <td><ion-skeleton-text animated></ion-skeleton-text></td>
              <td><ion-skeleton-text animated></ion-skeleton-text></td>
              <td><ion-skeleton-text animated></ion-skeleton-text></td>
            </tr>
          </table>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ng-template>

<ng-template #notificationSkeleton>
  <div class="arranging-contractor">
    <div class="banner">
      <div class="ion-text-left">
        <ion-skeleton-text class="header" animated style="width: 17%;height: 16px;"></ion-skeleton-text>
      </div>
      <h2 class="banner-heading">
        <ion-skeleton-text class="header" animated style="width: 25%;margin: auto;height: 20px;"></ion-skeleton-text></h2>
      <h6 class="banner-title"><ion-skeleton-text class="header" animated style="width: 20%;margin: auto;"></ion-skeleton-text></h6>
      <ion-skeleton-text class="header" animated style="width: 29%;margin: auto;height: 31px;border-radius: 5px;"></ion-skeleton-text>
      <ng-container>
        <h6 class="banner-title response-recived">
          <ion-skeleton-text class="header" animated style="width: 31%;height: 12px;margin: auto;"></ion-skeleton-text>
        </h6>
      </ng-container>

    </div>
    <div class="question-answer">
      <h6>  <ion-skeleton-text class="header" animated style="width: 48%;margin: auto;"></ion-skeleton-text></h6>
      <ion-grid>
        <ion-row class="ion-justify-content-center">
          <ng-container>
            <ion-skeleton-text class="header" animated style="width: 45%;margin: auto;"></ion-skeleton-text>
            <ion-skeleton-text class="header" animated style="width: 45%;margin: auto;"></ion-skeleton-text>
          </ng-container>
        </ion-row>
      </ion-grid>
    </div>
  </div>
</ng-template>

<ng-template #faultTitleSkeleton>
  <ion-grid>
    <ion-row class="ion-justify-content-start fault-title input-skeleton">
      <ion-col size="20">
        <ion-skeleton-text animated></ion-skeleton-text>
      </ion-col>
      <ion-col size="20">
        <ion-skeleton-text animated></ion-skeleton-text>
      </ion-col>
      <ion-col size="10" class="ion-align-self-center edit-title-icon" offset="2" *ngIf="faultId">
        <ion-skeleton-text animated></ion-skeleton-text>
      </ion-col>
    </ion-row>
  </ion-grid>
</ng-template>